/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java application project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/7.3/userguide/building_java_projects.html
 */

plugins {
    // Apply the application plugin to add support for building a CLI application in Java.
    id 'java'
    id 'application'
}

mainClassName = 'transactional.consumer.App'
sourceCompatibility = 11
targetCompatibility = 11

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
    maven { url "https://packages.confluent.io/maven/" }
}

dependencies {
    implementation group: 'org.apache.kafka', name: 'kafka-clients', version: '2.8.0'
    implementation group: "io.confluent", name: "monitoring-interceptors", version: '6.0.0'
    implementation group: 'org.slf4j', name: 'slf4j-log4j12', version: '1.7.30'
}

// application {
//     // Define the main class for the application.
//     mainClass = 'transactional.consumer.App'
// }

// run {
//     standardInput = System.in
// }

// run {
//     args = ["--myarg1", "--myarg2"]
// }

ext.javaMainClass = "transactional.consumer.TxOffsetCommit"
if (project.hasProperty("config") && project.hasProperty("in") && project.hasProperty("out")) {
    ext.cmdargs = project.getProperty('config')+' '+project.getProperty('in')+' '+project.getProperty('out')
} else { 
    ext.cmdargs = ""
}

task runTxOffsetConsumer(type: JavaExec) {
    group = "Application"
    classpath = sourceSets.main.runtimeClasspath
    main = 'transactional.consumer.TxOffsetCommit'    
    args cmdargs.split()
    standardInput = System.in
}

task runSyncOffsetConsumer(type: JavaExec) {    
    group = "Application"
    classpath = sourceSets.main.runtimeClasspath
    main = 'transactional.consumer.SyncOffsetCommit'    
    args cmdargs.split()
    standardInput = System.in
}